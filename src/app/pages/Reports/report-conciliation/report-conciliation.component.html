<ngx-spinner>
    <app-spinner></app-spinner>
</ngx-spinner>
<div class="card">
    <div class="flex flex-col">
        <div class="card">
            <div class="font-semibold text-xl mb-4">Conciliation</div>
            <p-toolbar>
                <ng-template #start>
                    <button pButton class="p-button-outlined mb-2" icon="pi pi-file-excel"
                        style="margin: 2px; color: #258a47; border-color:#258a47 ;" (click)="Excel()"></button>
                    <p-datepicker [iconDisplay]="'input'" [showIcon]="true" inputId="icondisplay"
                        placeholder="Start date" [(ngModel)]="FechaIni" />
                    <p style="margin-left: 5px;"></p>
                    <p-datepicker [iconDisplay]="'input'" [showIcon]="true" inputId="icondisplay" placeholder="End date"
                        [(ngModel)]="FechaFin" />
                </ng-template>
                <ng-template #end><p-datepicker [iconDisplay]="'input'" [showIcon]="true" inputId="icondisplay"
                        placeholder="Date" [(ngModel)]="FechaPrincipal" (ngModelChange)="changeFecha()" /></ng-template>
            </p-toolbar>
        </div>
    </div>
</div>
<div class="col-span-12 grid grid-cols-12 gap-4">
    <div class="card relative h-30 rounded-xl !p-4">
        <span class="text-sm font-medium leading-none">PAYIN AVAILABLE BALANCE</span>
        <div class="flex justify-between">
            <div class="flex justify-between items-center">
                <div class="leading-loose text-3xl">{{DataConciliationDto?.MontoDisponible | currency}}</div>
            </div>
        </div>
        <img class="absolute" style="bottom: 14px; right: 12px" src="/images/ecommerce-dashboard/value.svg" />

    </div>

    <div class="card relative h-28 rounded-xl !p-4">
        <span class="text-sm font-medium leading-none">COMMISSION PAYOUT</span>
        <div class="flex justify-between">
            <div class="flex justify-between items-center">
                <div class="flex justify-between items-center">
                    <div class="leading-loose text-3xl">{{DataConciliationDto?.MontoPayOut | currency }}</div>
                </div>
            </div>
        </div>
        <img class="absolute" style="bottom: 14px; right: 12px" src="/images/ecommerce-dashboard/quantity.svg" />

    </div>

    <div class="card relative h-28 rounded-xl !p-4">
        <span class="text-sm font-medium leading-none">COMMISSION PAYIN</span>
        <div class="flex justify-between">
            <div class="flex justify-between items-center">
                <div class="flex justify-between items-center">
                    <div class="leading-loose text-3xl">{{DataConciliationDto?.MontoPayIN | currency}}</div>
                </div>
            </div>
        </div>
        <img class="absolute" style="bottom: 14px; right: 12px; width: 15%;" src="/images/RunPay.ico" />

    </div>
</div>

<div class="card ">
    <p-toolbar>
        <ng-template #start>

        </ng-template>
        <ng-template #center>
            <div class="flex flex-wrap gap-4">
                <div class="flex items-center">
                    <p-radiobutton name="PayIn" value="PayIn" [(ngModel)]="table" inputId="PayIn"
                        (ngModelChange)="changeTable()" />
                    <label for="PayIn" class="ml-2">Pay In</label>
                </div>

                <div class="flex items-center">
                    <p-radiobutton name="PayOut" value="PayOut" [(ngModel)]="table" inputId="PayOut"
                        (ngModelChange)="changeTable()" />
                    <label for="PayOut" class="ml-2">Pay Out</label>
                </div>
            </div>
        </ng-template>
        <ng-template #end>
            <button pButton class="p-button-outlined mb-2" icon="pi pi-info-circle" style="margin: 2px;"
                (click)="Info()"></button>
        </ng-template>
    </p-toolbar>
    @if(this.table =='PayIn'){
    <div class="card">
        <p-table #dt1 [value]="DataPayInDto" dataKey="id" [rows]="15" [rowHover]="true" [showGridlines]="true"
            [paginator]="false" responsiveLayout="scroll">
            <ng-template #caption>
            </ng-template>
            <ng-template #header>
                <tr>
                    <th style="min-width: 12rem">
                        <div class="flex justify-between items-center">
                            Id transaccion
                        </div>
                    </th>
                    <th style="min-width: 12rem">
                        <div class="flex justify-between items-center">
                            FechaCreacion
                        </div>
                    </th>
                    <th style="min-width: 14rem">
                        <div class="flex justify-between items-center">
                            MontoPagado
                        </div>
                    </th>
                    <th style="min-width: 10rem">
                        <div class="flex justify-between items-center">
                            MontoDisponible
                        </div>
                    </th>
                    <th style="min-width: 10rem">
                        <div class="flex justify-between items-center">
                            MontoRunnPay
                        </div>
                    </th>
                    <th style="min-width: 10rem">
                        <div class="flex justify-between items-center">
                            Referencia
                        </div>
                    </th>
                </tr>
            </ng-template>
            <ng-template #body let-customer>
                <tr>
                    <td>
                        <span>{{ customer.Idtransaccion }}</span>
                    </td>
                    <td>
                        {{ customer.FechaCreacion | date: 'dd/MM/yyyy HH:mm:ss'}}
                    </td>
                    <td>
                        <span>{{ customer.MontoPagado | currency }}</span>

                    </td>
                    <td>
                        <span>{{ customer.MontoDisponible | currency }}</span>

                    </td>
                    <td>
                        <span>{{ customer.MontoRunnPay | currency }}</span>

                    </td>
                    <td>
                        {{ customer.Referencia}}
                    </td>
                </tr>
            </ng-template>
            <ng-template #emptymessage>
                <tr>
                    <td colspan="6">No customers found.</td>
                </tr>
            </ng-template>
            <ng-template #loadingbody>
                <tr>
                    <td colspan="6">Loading customers data. Please wait.</td>
                </tr>
            </ng-template>
        </p-table>
        <div class="col-6">
            <p-paginator (onPageChange)="PageChange($event)"
                [first]="(reportsService.contentData.pageNumber - 1) * reportsService.contentData.pageSize"
                [rows]="reportsService.contentData.pageSize" [totalRecords]="totalPa"
                [rowsPerPageOptions]="[15, 30, 45]" />
        </div>
    </div>
    }

    @if(this.table =='PayOut'){

    <div class="card">
        <p-table #dt1 [value]="DataPayOutDto" dataKey="id" [rows]="15" [rowHover]="true" [showGridlines]="true"
            [paginator]="false" responsiveLayout="scroll">
            <ng-template #caption>
            </ng-template>
            <ng-template #header>
                <tr>
                    <th style="min-width: 12rem">
                        <div class="flex justify-between items-center">
                            Id Dispersion
                        </div>
                    </th>
                    <th style="min-width: 12rem">
                        <div class="flex justify-between items-center">
                            FechaCreacion
                        </div>
                    </th>
                    <th style="min-width: 14rem">
                        <div class="flex justify-between items-center">
                            Estado
                        </div>
                    </th>
                    <th style="min-width: 10rem">
                        <div class="flex justify-between items-center">
                            MontoSolicitado
                        </div>
                    </th>
                    <th style="min-width: 10rem">
                        <div class="flex justify-between items-center">
                            Monto Banco
                        </div>
                    </th>
                    <th style="min-width: 10rem">
                        <div class="flex justify-between items-center">
                            Referencia
                        </div>
                    </th>
                </tr>
            </ng-template>
            <ng-template #body let-customer>
                <tr>
                    <td>
                        <span>{{ customer.IdDispersion }}</span>
                    </td>
                    <td>
                        {{ customer.FechaCreacion | date: 'dd/MM/yyyy HH:mm:ss'}}

                    </td>
                    <td>
                        {{ customer.Estado}}
                    </td>
                    <td>
                        {{ customer.MontoSolicitado | currency}}
                    </td>
                    <td>
                        {{ customer.MontoBanco | currency}}
                    </td>
                    <td>
                        {{ customer.Referencia}}
                    </td>

                </tr>
            </ng-template>
            <ng-template #emptymessage>
                <tr>
                    <td colspan="6">No customers found.</td>
                </tr>
            </ng-template>
            <ng-template #loadingbody>
                <tr>
                    <td colspan="6">Loading customers data. Please wait.</td>
                </tr>
            </ng-template>
        </p-table>
        <div class="col-6">
            <p-paginator (onPageChange)="PageChange($event)"
                [first]="(reportsService.contentData.pageNumber - 1) * reportsService.contentData.pageSize"
                [rows]="reportsService.contentData.pageSize" [totalRecords]="totalPa"
                [rowsPerPageOptions]="[15, 30, 45]" />
        </div>
    </div>
    }
</div>

<p-dialog header="PAYIN AND PAYOUT CONFIGURATION" [(visible)]="ActiveInfo" [breakpoints]="{ '960px': '75vw' }"
    [style]="{ width: '30vw' }" [modal]="true">
    <div class="bg-white p-6 rounded-lg shadow-lg w-[90%] max-w-3xl">
    
        <table class="w-full text-left border border-gray-300">
          <thead class="bg-gray-100">
            <tr>
              <th class="p-2 border">Concept</th>
              <th class="p-2 border">amount</th>
              <th class="p-2 border">Percentage</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let medio of CongigPayInDto">
              <td class="p-2 border">PayIn - {{ medio.Descripcion }}</td>
              <td class="p-2 border">{{ medio.Valor | currency}}</td>
              <td class="p-2 border">{{ medio.Porcentaje }}%</td>
            </tr>
            <tr>
              <td class="p-2 border">PayOut</td>
              <td class="p-2 border">{{ CongigPayOutDto?.payOut | currency}}</td>
              <td class="p-2 border">{{ CongigPayOutDto?.porCentajePayOut}}%</td>
            </tr>
            <tr>
              <td class="p-2 border">PayOut Nequi</td>
              <td class="p-2 border">{{ CongigPayOutDto?.payOutNequi| currency }}</td>
              <td class="p-2 border">{{ CongigPayOutDto?.porCentajeNequiPayOut }}%</td>
            </tr>
          </tbody>
        </table>
      </div>
</p-dialog>